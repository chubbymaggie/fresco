#!/usr/bin/make -f
# This package uses debhelper, you must have it installed to create
# a debian package.

LIBDIR=`pwd`/debian/tmp/usr/Berlin/lib
BINDIR=`pwd`/debian/tmp/usr/Berlin/bin
INCDIR=`pwd`/debian/tmp/usr/Berlin/include
IDLDIR=`pwd`/debian/tmp/usr/Berlin/include/idl
DOCDIR=`pwd`/debian/tmp/usr/doc/Berlin

# Turn on verbose mode
#export DH_VERBOSE=1

build: build-stamp
build-stamp:
	dh_testdir
	$(MAKE)
	touch build-stamp

clean:
	dh_testdir
	dh_testroot
	rm -f build-stamp install-stamp
	-$(MAKE) clean
	dh_clean

install: install-stamp
install-stamp:
	dh_testdir
	dh_testroot
	dh_clean -k
	dh_installdirs
	# yes this is ugly
	cp -f lib/libBerlin.so $(LIBDIR)
	cp -f lib/libGLtt.so $(LIBDIR)
	cp -f lib/libText.so $(LIBDIR)
	cp -f lib/libDrawing.so $(LIBDIR)
	cp -f lib/libLayout.so $(LIBDIR)
	cp -f lib/libWarsaw.so $(LIBDIR)
	cp -f lib/libFigure.so $(LIBDIR)
	cp -f lib/libPrague.so $(LIBDIR)
	cp -f lib/libWidget.so $(LIBDIR)
	cp -f test/button $(BINDIR)
	cp -f test/draggable $(BINDIR)
	cp -f test/server $(BINDIR)
	cp -f test/terminal $(BINDIR)
	cp -f include/Warsaw/*.idl $(IDLDIR)/Warsaw
	cp -f include/Berlin/*.hh $(INCDIR)/Berlin
	cp -f include/Command/*.hh $(INCDIR)/Command
	cp -f include/Figure/*.hh $(INCDIR)/Figure
	cp -f include/Layout/*.hh $(INCDIR)/Layout
	cp -f include/Prague/Filter/*.hh $(INCDIR)/Prague/Filter
	cp -f include/Prague/IPC/*.hh $(INCDIR)/Prague/IPC
	cp -f include/Prague/Network/*.hh $(INCDIR)/Prague/Network
	cp -f include/Prague/Sys/*.hh $(INCDIR)/Prague/Sys
	cp -f include/Drawing/openGL/*.hh $(INCDIR)/Drawing/openGL
	cp -f include/Drawing/openGL/gltt/*.h $(INCDIR)/Drawing/openGL/gltt
	cp -f include/Text/*.hh $(INCDIR)/Text
	cp -f include/Widget/*.hh $(INCDIR)/Widget
	cp -f README.FIRST $(DOCDIR)
	cp -f doc/*.sgm $(DOCDIR)
	cp -f doc/*.html $(DOCDIR)
	cp -f doc/html/*.html $(DOCDIR)/html
	dh_movefiles
	# clean up
	rm -rf $(INCDIR)
	rm -rf $(DOCDIR)
	touch install-stamp

binary-indep: build install
binary-arch: build install
	dh_testdir
	dh_testroot
	dh_compress
	dh_fixperms
	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

source diff:
	@echo >&2 'source and diff are obsolete - use dpkg-source -b'; false

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary
